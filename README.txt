Combining bisulfite treatment of DNA and next-generation sequencing
technology (BS-seq) allows the capturing of a snapshot of a cell's
or tissue's epigenomic state by revealing cytosine methylation at
single-base resolution on a genome-wide scale. Bisulfite treatment
of DNA leaves methylated cytosines untouched, however non-methylated
cytosines are converted into uracils; this conversion renders mapping
of these sequences to a reference genome challenging.

Bismark is a new tool for the time-efficient analysis of BS-seq data. 
Bismark is a software package written in Perl that is based on the 
short read aligner Bowtie. All associated files can be downloaded at:

http://www.bioinformatics.bbsrc.ac.uk/projects/


How does Bismark work?

Bismark supports both single-end and paired-end read mapping in either 
fastA or fastQ format, while retaining much of the flexibility of 
Bowtie (adjust the seed length, number of mismatches, --best...). 
Sequence reads are first transformed into fully bisulfite-converted 
forward (C > T) and reverse reads (G > A conversion of the forward
strand), before aligning them to similarly converted versions of the 
genome (also C>T and G>A). Sequence reads that produce a unique best 
alignment from the four alignment processes against the bisulfite 
genome (which are running in parallel), are then compared to the normal 
genomic sequence and the methylation state of all cytosine positions in 
the read is determined. 



What does the output look like?

In the first instance, Bismark produces a comprehensive output file which 
can either be imported into a genome viewer (e.g. SeqMonk using the Bismark
import filter option) or be further mined by downstream scripts.

The single-end output contains the following information:

 (1) seq-ID
 (2) alignment strand
 (3) chromosome
 (4) start 
 (5) end
 (6) observed bisulfite sequence 
 (7) equivalent genomic sequence
 (8) methylation call string 
 (9) read conversion
(10) genome conversion

Single-end alignment example: 

HWUSI-EAS611_0001:3:1:1186:18334#0/1 
+ 
4 
122893213 
122893242 
TGGGTTTTTAAGATTTTGTGTAGTTGGGGTTTGGAGATGG 
CGGGCCCTCAAGACCCTGCGCAGCTGGGGCCTGGAGACGGA 
z...ccc.c....ccc..z.c..c.....cc......z.. 
CT 
CT 


The paired-end output contains the following information:

 (1) seq-ID
 (2) alignment strand
 (3) chromosome
 (4) start 
 (5) end
 (6) observed bisulfite sequence 1 
 (7) equivalent genomic sequence 1 
 (8) methylation call string 1 
 (9) observed bisulfite sequence 2 
(10) equivalent genomic sequence 2 
(11) methylation call string 2
(12) read 1 conversion
(13) genome conversion


Paired-end alignment example:

HWUSI-EAS611_100205:2:1:13:1732#0 
+ 
14 
62880539 
62880652 
CGGGATTTCGCGGAGTACGGGTGATCGTGTGGAATATAGA 
CGGGACTCCGCGGAGCACGGGTGACCGTGTGGAATACAGAG 
Z....c.cZ.Z.. ..c.Z......cZ..........c... 
 CAACTATCTAAAACTAAAAATAACGCCGCCCAAAAACTCT 
CCGGCTGTCTGGAGCTGAAGATGGCGCCGCCCAGAAGCTCT 
.zc..c...cc.c..c..c..cc.Z..Z....c..c.... 
CT 
CT


In the current version, Bismark discriminates between cytosines in CpG 
context or in non-CpG context. 

Bismark comes with a supplementary methylation extractor script that 
operates on Bismark result files and extracts the methylation call 
for every single C analysed. It comes with a few options, such as 
ignoring the first <int> number of positions in the methylation call string, 
e.g. to remove a restriction enzyme site. The position of every single C
will be written out to a new output file, depending on context (CpG or 
any other), whereby methylated Cs will be labelled as forward reads, 
non-methylated Cs as reverse reads. These positions can then be imported 
into a genome viewer (e.g. SeqMonkk, this time using the generic text import
filter) and data analysis can commence. This output is regularly analysed 
by the researchers at our institute themselves!
  
Because the output files can become very large (an Illumina lane with 
35 million reads can potentially contain a LOT of Cs!), one can either 
specify to get a large, comprehensive output or obtain strand-specific 
outputs (every read can potentially originate from each of the four strands 
generated by a bisulfite PCR. Please be aware that it does not make any 
sense to look at strand-specific methylation if the bisulfite experiment 
did not conserve strand-specificity in the first place. In these cases, 
the individual files can and should later on in SeqMonk be merged into 
a data group again (generic text import)).



Some stats

So far we have successfully used Bismark for bisulfite mapping against 
various genomes (mouse NCBIM37, human NCBI36 and GRCh37, or Yeast SGD1.01) 
and confirmed its functionality by re-analysing a number of published results. 
Depending on the type of experiment we typically see alignment rates of 55-70%. 

Bismark holds the reference genome in memory, in addition the 4 parallel 
instances of bowtie need some memory as well. Therefore I estimate the memory
usage to be around 8-10GB (we can run 2 instances of Bismark on a 2 year 
old quad-core, 24GB RAM linux server at the same time). Alignment speed depends 
largely on the read length and the bowtie parameters specified; allowing many
mismatches and specifying --best is rather slow, whereas only looking for 
perfect matches can easily reach 5-10 million sequences per hour.

If you have any comments about Bismark we would like to hear them. You can 
either enter them in our bug tracking system at: 
http://www.bioinformatics.bbsrc.ac.uk/bugzilla/ or send a message directly 
to felix.krueger@bbsrc.ac.uk.

